{"version":3,"file":"voiceBot.js","sourceRoot":"","sources":["voiceBot.ts"],"names":[],"mappings":"AA0BA;;GAEG;AACH,MAAM,CAAN,IAAY,qBAQX;AARD,WAAY,qBAAqB;IAC/B,6DAAoC,CAAA;IACpC,4DAAmC,CAAA;IACnC,sEAA6C,CAAA;IAC7C,wEAA+C,CAAA;IAC/C,+DAAsC,CAAA;IACtC,wDAA+B,CAAA;IAC/B,sDAA6B,CAAA;AAC/B,CAAC,EARW,qBAAqB,KAArB,qBAAqB,QAQhC;AA4CD;;GAEG;AACH,MAAM,CAAN,IAAY,kBASX;AATD,WAAY,kBAAkB;IAC5B,yDAAmC,CAAA;IACnC,uDAAiC,CAAA;IACjC,uDAAiC,CAAA;IACjC,uDAAiC,CAAA;IACjC,qEAA+C,CAAA;IAC/C,iDAA2B,CAAA;IAC3B,yEAAmD,CAAA;IACnD,8EAAwD,CAAA;AAC1D,CAAC,EATW,kBAAkB,KAAlB,kBAAkB,QAS7B;AAeD;;GAEG;AACH,MAAM,UAAU,qBAAqB,CACnC,eAAgC;IAEhC,OAAO,CACL,aAAa,CAAC,eAA8B,CAAC;QAC7C,kBAAkB,CAAC,eAAmC,CAAC,CACxD,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,MAAM,UAAU,gBAAgB,CAC9B,eAAgC;IAEhC,OAAQ,eAAkC,CAAC,WAAW,KAAK,SAAS,CAAC;AACvE,CAAC;AAED;;GAEG;AACH,MAAM,UAAU,aAAa,CAC3B,mBAAwC;IAExC,OAAQ,mBAAmC,CAAC,IAAI,KAAK,SAAS,CAAC;AACjE,CAAC;AAED;;GAEG;AACH,MAAM,UAAU,kBAAkB,CAChC,mBAAwC;IAExC,OAAQ,mBAAwC,CAAC,SAAS,KAAK,SAAS,CAAC;AAC3E,CAAC","sourcesContent":["/**\n * Types related to the Voice Bot state management\n */\nimport { AgentState } from './agent';\n\n/**\n * Conversation message types\n */\nexport type UserMessage = { user: string };\nexport type AssistantMessage = { assistant: string };\nexport type ConversationMessage = UserMessage | AssistantMessage;\n\n/**\n * Latency message for tracking response times\n */\nexport interface LatencyMessage {\n  total_latency: number | null;\n  tts_latency: number;\n  ttt_latency: number;\n}\n\n/**\n * All message types that can be in the voice bot state\n */\nexport type VoiceBotMessage = ConversationMessage | LatencyMessage;\n\n/**\n * Behind the scenes event types\n */\nexport enum BehindScenesEventType {\n  SETTINGS_APPLIED = 'SettingsApplied',\n  AGENT_AUDIO_DONE = 'AgentAudioDone',\n  USER_STARTED_SPEAKING = 'UserStartedSpeaking',\n  AGENT_STARTED_SPEAKING = 'AgentStartedSpeaking',\n  CONVERSATION_TEXT = 'ConversationText',\n  END_OF_THOUGHT = 'EndOfThought',\n  INTERRUPTION = 'Interruption',\n}\n\n/**\n * Behind the scenes event structure\n */\nexport type BehindScenesEvent =\n  | { type: BehindScenesEventType.SETTINGS_APPLIED }\n  | { type: BehindScenesEventType.AGENT_AUDIO_DONE }\n  | { type: BehindScenesEventType.USER_STARTED_SPEAKING }\n  | { type: BehindScenesEventType.AGENT_STARTED_SPEAKING }\n  | { type: BehindScenesEventType.CONVERSATION_TEXT; role: 'user' | 'assistant'; content: string }\n  | { type: BehindScenesEventType.END_OF_THOUGHT }\n  | { type: BehindScenesEventType.INTERRUPTION };\n\n/**\n * Voice bot state\n */\nexport interface VoiceBotState {\n  /**\n   * Current status of the voice bot\n   */\n  status: AgentState;\n\n  /**\n   * Seconds since last activity (for auto-sleep)\n   */\n  sleepTimer: number;\n\n  /**\n   * Conversation and latency messages\n   */\n  messages: VoiceBotMessage[];\n\n  /**\n   * Behind the scenes events for debugging\n   */\n  behindScenesEvents: BehindScenesEvent[];\n\n  /**\n   * Whether params should be attached to copy URL\n   */\n  attachParamsToCopyUrl?: boolean;\n}\n\n/**\n * Action types for the reducer\n */\nexport enum VoiceBotActionType {\n  START_LISTENING = 'start_listening',\n  START_THINKING = 'start_thinking',\n  START_SPEAKING = 'start_speaking',\n  START_SLEEPING = 'start_sleeping',\n  INCREMENT_SLEEP_TIMER = 'increment_sleep_timer',\n  ADD_MESSAGE = 'add_message',\n  ADD_BEHIND_SCENES_EVENT = 'add_behind_scenes_event',\n  SET_PARAMS_ON_COPY_URL = 'set_attach_params_to_copy_url',\n}\n\n/**\n * Voice bot actions\n */\nexport type VoiceBotAction =\n  | { type: VoiceBotActionType.START_LISTENING }\n  | { type: VoiceBotActionType.START_THINKING }\n  | { type: VoiceBotActionType.START_SPEAKING }\n  | { type: VoiceBotActionType.START_SLEEPING }\n  | { type: VoiceBotActionType.INCREMENT_SLEEP_TIMER }\n  | { type: VoiceBotActionType.ADD_MESSAGE; payload: VoiceBotMessage }\n  | { type: VoiceBotActionType.ADD_BEHIND_SCENES_EVENT; payload: BehindScenesEvent }\n  | { type: VoiceBotActionType.SET_PARAMS_ON_COPY_URL; payload: boolean };\n\n/**\n * Type guard for conversation messages\n */\nexport function isConversationMessage(\n  voiceBotMessage: VoiceBotMessage\n): voiceBotMessage is ConversationMessage {\n  return (\n    isUserMessage(voiceBotMessage as UserMessage) ||\n    isAssistantMessage(voiceBotMessage as AssistantMessage)\n  );\n}\n\n/**\n * Type guard for latency messages\n */\nexport function isLatencyMessage(\n  voiceBotMessage: VoiceBotMessage\n): voiceBotMessage is LatencyMessage {\n  return (voiceBotMessage as LatencyMessage).tts_latency !== undefined;\n}\n\n/**\n * Type guard for user messages\n */\nexport function isUserMessage(\n  conversationMessage: ConversationMessage\n): conversationMessage is UserMessage {\n  return (conversationMessage as UserMessage).user !== undefined;\n}\n\n/**\n * Type guard for assistant messages\n */\nexport function isAssistantMessage(\n  conversationMessage: ConversationMessage\n): conversationMessage is AssistantMessage {\n  return (conversationMessage as AssistantMessage).assistant !== undefined;\n}\n"]}