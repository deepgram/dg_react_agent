{"version":3,"file":"AgentState.js","sourceRoot":"","sources":["AgentState.ts"],"names":[],"mappings":";AA0BA,MAAM,CAAC,IAAM,YAAY,GAAqB;IAC5C,uBAAuB,EAAE,cAAc;IACvC,eAAe,EAAE,cAAc;IAC/B,UAAU,EAAE,MAAM;IAClB,WAAW,EAAE,KAAK;IAClB,SAAS,EAAE,KAAK;IAChB,aAAa,EAAE,KAAK;IACpB,OAAO,EAAE,KAAK;CACf,CAAC;AAaF,MAAM,UAAU,YAAY,CAAC,KAAuB,EAAE,KAAiB;IACrE,QAAQ,KAAK,CAAC,IAAI,EAAE;QAClB,KAAK,YAAY;YACf,6BAAY,KAAK,KAAE,aAAa,EAAE,IAAI,IAAG;QAE3C,KAAK,WAAW;YACd,6BAAY,KAAK,KAAE,OAAO,EAAE,KAAK,CAAC,OAAO,IAAG;QAE9C,KAAK,8BAA8B;YACjC,6BAAY,KAAK,KAAE,uBAAuB,EAAE,KAAK,CAAC,KAAK,IAAG;QAE5D,KAAK,sBAAsB;YACzB,6BAAY,KAAK,KAAE,eAAe,EAAE,KAAK,CAAC,KAAK,IAAG;QAEpD,KAAK,iBAAiB;YACpB,6BAAY,KAAK,KAAE,UAAU,EAAE,KAAK,CAAC,KAAK,IAAG;QAE/C,KAAK,eAAe;YAClB,6BAAY,KAAK,KAAE,WAAW,EAAE,KAAK,CAAC,WAAW,IAAG;QAEtD,KAAK,aAAa;YAChB,6BAAY,KAAK,KAAE,SAAS,EAAE,KAAK,CAAC,SAAS,IAAG;QAElD,KAAK,WAAW;YACd,6BAAY,KAAK,KAAE,SAAS,EAAE,KAAK,CAAC,KAAK,IAAG;QAE9C,KAAK,OAAO;YACV,OAAO,YAAY,CAAC;QAEtB;YACE,OAAO,KAAK,CAAC;KAChB;AACH,CAAC;AAED,kBAAkB;AAClB,MAAM,CAAC,IAAM,SAAS,GAAG;IACvB,gBAAgB,EAAE,UAAC,KAAuB;QACxC,OAAO,KAAK,CAAC,uBAAuB,KAAK,WAAW,IAAI,KAAK,CAAC,eAAe,KAAK,WAAW,CAAC;IAChG,CAAC;IAED,kBAAkB,EAAE,UAAC,KAAuB;QAC1C,OAAO,KAAK,CAAC,uBAAuB,KAAK,OAAO,IAAI,KAAK,CAAC,eAAe,KAAK,OAAO,CAAC;IACxF,CAAC;IAED,uBAAuB,EAAE,UAAC,KAAuB;QAC/C,IAAI,SAAS,CAAC,kBAAkB,CAAC,KAAK,CAAC;YAAE,OAAO,OAAO,CAAC;QACxD,IAAI,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC;YAAE,OAAO,WAAW,CAAC;QAC1D,IAAI,KAAK,CAAC,uBAAuB,KAAK,YAAY,IAAI,KAAK,CAAC,eAAe,KAAK,YAAY,EAAE;YAC5F,OAAO,YAAY,CAAC;SACrB;QACD,OAAO,cAAc,CAAC;IACxB,CAAC;CACF,CAAC","sourcesContent":["import { AgentState as AgentStateType, AgentOptions } from '../../types/voice';\nimport { ConnectionState } from '../../types/common/connection';\n\nexport interface AgentSystemState {\n  // Connection states\n  transcriptionConnection: ConnectionState;\n  agentConnection: ConnectionState;\n  \n  // Agent state\n  agentState: AgentStateType;\n  \n  // Audio states\n  isRecording: boolean;\n  isPlaying: boolean;\n  \n  // Configuration\n  agentOptions?: AgentOptions;\n  \n  // Error states\n  lastError?: Error;\n  \n  // Metadata\n  isInitialized: boolean;\n  isReady: boolean;\n}\n\nexport const initialState: AgentSystemState = {\n  transcriptionConnection: 'disconnected',\n  agentConnection: 'disconnected',\n  agentState: 'idle',\n  isRecording: false,\n  isPlaying: false,\n  isInitialized: false,\n  isReady: false\n};\n\nexport type StateEvent = \n  | { type: 'INITIALIZE' }\n  | { type: 'SET_READY'; isReady: boolean }\n  | { type: 'SET_TRANSCRIPTION_CONNECTION'; state: ConnectionState }\n  | { type: 'SET_AGENT_CONNECTION'; state: ConnectionState }\n  | { type: 'SET_AGENT_STATE'; state: AgentStateType }\n  | { type: 'SET_RECORDING'; isRecording: boolean }\n  | { type: 'SET_PLAYING'; isPlaying: boolean }\n  | { type: 'SET_ERROR'; error: Error }\n  | { type: 'RESET' };\n\nexport function stateReducer(state: AgentSystemState, event: StateEvent): AgentSystemState {\n  switch (event.type) {\n    case 'INITIALIZE':\n      return { ...state, isInitialized: true };\n    \n    case 'SET_READY':\n      return { ...state, isReady: event.isReady };\n    \n    case 'SET_TRANSCRIPTION_CONNECTION':\n      return { ...state, transcriptionConnection: event.state };\n    \n    case 'SET_AGENT_CONNECTION':\n      return { ...state, agentConnection: event.state };\n    \n    case 'SET_AGENT_STATE':\n      return { ...state, agentState: event.state };\n    \n    case 'SET_RECORDING':\n      return { ...state, isRecording: event.isRecording };\n    \n    case 'SET_PLAYING':\n      return { ...state, isPlaying: event.isPlaying };\n    \n    case 'SET_ERROR':\n      return { ...state, lastError: event.error };\n    \n    case 'RESET':\n      return initialState;\n    \n    default:\n      return state;\n  }\n}\n\n// State selectors\nexport const selectors = {\n  isFullyConnected: (state: AgentSystemState): boolean => {\n    return state.transcriptionConnection === 'connected' && state.agentConnection === 'connected';\n  },\n  \n  hasConnectionError: (state: AgentSystemState): boolean => {\n    return state.transcriptionConnection === 'error' || state.agentConnection === 'error';\n  },\n  \n  overallConnectionStatus: (state: AgentSystemState): ConnectionState => {\n    if (selectors.hasConnectionError(state)) return 'error';\n    if (selectors.isFullyConnected(state)) return 'connected';\n    if (state.transcriptionConnection === 'connecting' || state.agentConnection === 'connecting') {\n      return 'connecting';\n    }\n    return 'disconnected';\n  }\n};\n"]}